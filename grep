yarn run v1.22.4
$ DEBUG=bobaserver:* ./node_modules/mocha/bin/mocha --exclude './node_modules/**' --timeout 3000 -r ts-node/register -r dotenv/config './**/*.test.ts' auth-log


  Tests notifications
    ✓ gets correct amounts with no visit
    ✓ gets correct amounts with new comments (self)
    ✓ gets correct amounts with new comments (not self)
    ✓ gets correct amounts with new posts (self)
    ✓ gets correct amounts with new posts (not self)
    ✓ gets correct amounts with no updates
    ✓ gets correct amounts (logged out)
    ✓ gets correct amounts with dismissed notifs (new entries)
    ✓ gets correct amounts with dismissed notifs (no new entries)
    ✓ gets correct amounts with dismissed notifs (mixed visits and dismiss)

  Tests boards queries
    ✓ fetches first page, gets cursor back
    ✓ fetches second page, gets cursor back
    ✓ fetches last page, gets no cursor back
    ✓ fetches correctly when only one result after current page
    ✓ fetches correctly when no result after current page (outdated cursor)
    ✓ fetches correctly when post includes microseconds

  Tests boards queries
    ✓ fetches all boards (with user)
    ✓ fetches all boards (no user)
    ✓ fetches all boards with dismissed notifications
    ✓ fetches board by slug when slug present
    ✓ returns empty board when slugs not found
    ✓ fetches board activity when slug present (logged in)
    ✓ fetches board activity when slug present (logged out)
    ✓ fetches empty board activity

  test identities
    ✓ merges comments and identities
    ✓ merges comments and identities
    ✓ merges comments and identities

  threads activity queries
    ✓ gets correct amounts with no visit
    ✓ gets correct amounts with new comments (self)
    ✓ gets correct amounts with new comments (not self)
    ✓ gets correct amounts with new posts (self)
    ✓ gets correct amounts with new posts (not self)
    ✓ gets correct amounts with no updates
    ✓ gets correct amounts (logged out)
    ✓ gets correct amounts with dismiss notifications (new)
    ✓ gets correct amounts with dismiss notifications (no new)
    Test correct amounts with both dismiss and visit
      ✓ Visited earlier than dismiss
      ✓ Visited after dismiss
      ✓ Never visited, created before dismiss
      ✓ Never visited, created after dismiss

  threads queries
    ✓ fetches threads by string id (with comments)
    ✓ fetches threads by string id (no comments)
    ✓ fetches threads by string id (logged out)
    ✓ returns null thread when id not found
    ✓ fetches thread identities by string id
    ✓ return false for thread identities when thread not found

  Tests boards REST API
    ✓ should return board data
    ✓ should return activity data

  Tests threads REST API
    ✓ should return threads data


  49 passing (321ms)

Done in 13.83s.
